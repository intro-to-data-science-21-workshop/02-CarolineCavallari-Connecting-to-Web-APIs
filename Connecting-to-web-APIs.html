<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Connecting to APIs in the Web</title>
    <meta charset="utf-8" />
    <meta name="author" content="Caroline Cavallari &amp; Jose de Los Heros" />
    <meta name="date" content="2021-04-11" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Connecting to APIs in the Web
### Caroline Cavallari &amp; Jose de Los Heros
### Hertie School
### 04/11/21

---








# Our agenda for today:

&lt;br&gt;

1. Definition of web APIs

2. How web APIs work and why are they important

4. Introduction to HTTR package

5. Introduction to jsonlite package

6. More resources

7. Do it yourself time!

---

name: intro

#Introduction to web APIs

##What are APIs?

API stands for 'Application Programming Interface‚Äô. 

It is a contract on how computers can communicate to each other. Web APIs allow communication between: a client, your R script  and a server, which hosts a website. 

- Server: it is like a big computer, capable of doing different things such as: storing data or performing different tasks
- Client: companies or you, data analysts üë©‚Äçüíª 

One important thing to know is that Web APIs are often organized hierarchically, as in a family tree-map format, containing different levels of information that can be accessed by the client. Therefore, you have to understand theinformation that you need, in order to understand the level that it is in.     

---

name: what APIs do?

**What APIs do?**
- Make it easier for a computer to interact with data on server
- Allows access to ‚Äòhidden‚Äô part of website


![ ](./Images/Image_1.jpeg)

---
name: What are APIs good for?

#What are APIs good for?

When you need data from website in a programmatic manner:

- A lot of data
- Data gets updated constantly (weather, price of gold) 

**What are their strengths?**
- Unlike in webscraping, there is a structured way to access data in APIs. 
- Data is obtained in a standardized format.

**What are their disadvantages?**
- You need to know how to ask the right questions in order to get the answers that you want. To do that, you need to know the API very well, and that might be a challenge!
- There are multiple system and different ways to do it, depending on how the API was designed.

---

name: But, why do companies have APIs?

#But, why do companies have APIs?

Imagine if everyone decided to retrieve data from a server in an unstructured way. The amount of energy that this would consume would be very high. Now, the company can provide an organized way for clients to retrieve a large amount of data, without overwhelming or crashing their server.

Moreover, APIs allows for more:

- Innovation: clients have access to data, can develop their own products and solutions
- Expansion: APIs can help companies move to different markets or even partner with other companies
- Variety: Allows for a large amount of content to be provided in  the internet
- For people: APIs are very important for research, people can find solutions to many different problems just by having access to structured dataframes. 


---

name: Still confused on what are APIs?

#Still confused on what are APIs?

.pull-left[
**Let me give you an example:** Many companies use APIs today to allow for their clients to retrieve data and create their own apps, softwares and solutions. 

&lt;br&gt; 

**Exammples:**
&lt;br&gt; 
&lt;img style="padding-right: 40px" src="Images/Image_3.jpeg" height=80&gt;
&lt;img src="Images/Image_4.png" height=80&gt;
&lt;img src="Images/Image_5.png"height=80&gt;
&lt;img src="Images/Image_6.png"height=80&gt;
&lt;img src="Images/Image_8.png"height=80&gt;
&lt;/div&gt;

]

.pull-right[
**Spotify**: remember when Spotify asks to connect to your friends in Facebook? What is happening there is an API, a website (spotify) is pulling data from the other (Facebook).

&lt;br&gt; 

&lt;img style="padding-right: 100px" img src="Images/Image_9.png"height=200&gt;
&lt;/div&gt;

]
---

name: What is  the logic of APIs?

.pull-left[
#What is  the logic of APIs?
In order for APIs to be done, computers need a protocol. 
*But what does that mean?*

It means that a set of rules define how a computer reads a message.  This set of rules is the internet's protocol, also known as HTTP.  

This is also known as a Request-Response Cycle: We can ask the server to do something, and the server will tell us if it can be done or not (Cooksey, 2014) 


&lt;img style="padding-right: 100px" img src="Images/Image_10.png"height=200&gt;
&lt;/div&gt;

]


.pull-right[
## Making Valid Requests
Also, according to Cooksey (2014), to make a valid request, the client needs to include four things:

- **URL (Uniform Resource Locator)**: is a text "address" that specifies where a resource (webpage, video) is located on the internet

- **Method**: the verbs used to talk with the server (ex: `GET()`, `DELETE()`,`POST()`)

- **List of Headers**: will describe the body included in our request

- **Body**: this is the the data itself, the content we are interested in retrieving
]

---

name: The HTTR Package

#The HTTR Package
`httr` connects your data to a server and organizes it according to your setups. This means that HTTR helps you to **make a request** to a server. The most frequently used functions in this package are:

- **HEAD():** returns the headers of your metadata but without the data itself, allowing you to understand your variables before moving everything to your R.

- **GET():** tells the server to get the information from the url into your scripts.

- **POST():** tells the server to create a new resource. 

- **PUT():** tell the server to update a source

- **PATCH():** tells the server to modify a resource.

- **DELETE():** tells the server to delete a resource.



---

name: The tructure of a HTTTP

#The Structure of a HTTP


&lt;img style="padding-right: 100px" img src="Images/Image_11.png"height=400&gt;
&lt;/div&gt;


---


name: Checking for Errors

.pull-left[
#Checking for Errors

*How do we check for errors before we continue?*

When we are building APIs and retrieving the url, it's important to check whether our url is valid and whether it is working before we start retrieving data.

In order to check our url we can run **http_status()**: which will tell us the status of our code and whether our operation was successful or not.
]

.pull-right[
#Most Common Errors

Most APIs documents in websites and platforms will tell you how their error code works, but here is an example of the most common:

![ ](./Images/Image_2.jpeg)

- 200	OK: The request was sucessful. The client can read the result of the request 
- 400: The request could not be understood by the server due to malformed syntax. 
- 



---

name:The jsonlite package

#The jsonlite package

&lt;img src="./Images/gif_jason.gif" style="display: block; margin: auto;" /&gt;

---

name: But now the real jsonlite package

#But now the real jsonlite package

*What does this package do?*

The `jsonlite` package is a parser, that will tell your API how to read the data being retrieved in the JSON (JavaScript Object Notation) format. `JSON()` converts R objects to JSON language and vice-versa. 


---

name: Overall design

#Overall design


The key features of any API are the structure of the requests and the structure of the responses. An HTTP request consists of the following parts:

HTTP verb (GET, POST, DELETE, etc.)
The base URL for the API
The URL path or endpoint
URL query arguments (e.g., ?foo=bar)
Optional headers
An optional request body

example:
- url &lt;- "https://api.tvmaze.com/search/shows?q=girls"
- httr::GET(url)
- Query arguments: APIs are structured in a way for you to specify information that you are looking for. In the above example, we specified q=girls -&gt; query=girls. We want to retrieve data from all tv programs that have "girls" on their name.
- 
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9",
"hash": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
